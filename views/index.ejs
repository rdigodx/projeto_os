<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel de Ordens de Servi√ßo</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="icon" type="image/png" href="/images/logo.png"/>
</head>

<body>

<header>
  <div class="header-container">
    <a href="/">
      <img src="/images/logo.png" alt="Logo MBM Copy" class="logo">
    </a>

    <nav>
      <ul class="nav-links">
        <li>
          <a href="/login" class="btn btn-secondary">
            <i class="fas fa-user"></i> T√©cnico
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>

<!-- HERO -->
<section class="hero">
  <h1>
    <span>Portal de Chamados</span><br>
    TI MBM
  </h1>
</section>

<main>
  <div class="main-container">

    <!-- ALERTAS -->
    <%- include('partials/alerts') %>

    <section class="ordem-detalhes">
      <h2><i class="fas fa-search"></i> Consultar Ordem de Servi√ßo</h2>
      <div id="tokenFormFeedback" class="form-feedback-slot" aria-live="polite"></div>
      <form method="GET" action="/" class="filtro-container">
        <input
          type="text"
          id="token-busca"
          name="token"
          class="filtro-input"
          placeholder="Digite o token de acompanhamento"
          value="<%= tokenInformado || '' %>"
          maxlength="20"
          required
        />
        <div style="margin-top: 0.75rem;">
          <button type="submit" class="btn">
            <i class="fas fa-search"></i> Buscar OS
          </button>
        </div>
      </form>

      <% if (consultaErro) { %>
        <div class="messages-container">
          <div class="message warning" role="alert">
            <span class="message-marker" aria-hidden="true"></span>
            <div class="message-text"><%= consultaErro %></div>
            <button
              type="button"
              class="message-close-btn"
              aria-label="Fechar mensagem"
              onclick="this.closest('.message').remove();"
            >&times;</button>
          </div>
        </div>
      <% } %>
    </section>

    <% if (ordem) { %>
      <section class="ordem-detalhes">
        <h2><i class="fas fa-info-circle"></i> Detalhes da Ordem de Servi√ßo</h2>

        <div class="filtro-container">
          <input
            type="text"
            id="filtro-os"
            class="filtro-input"
            placeholder="Filtrar informa√ß√µes da OS..."
          />
        </div>

        <div class="os-grid">
          <div class="os-item"><strong>Solicitante:</strong> <%= ordem.solicitante %></div>
          <div class="os-item"><strong>Setor:</strong> <%= ordem.setor %></div>
          <div class="os-item"><strong>Tipo:</strong> <%= ordem.tipo_servico %></div>
          <div class="os-item"><strong>Status:</strong> <%= ordem.status %></div>
          <div class="os-item"><strong>Data:</strong> <%= new Date(ordem.data_criacao).toLocaleString("pt-BR") %></div>
          <div class="os-item"><strong>Token:</strong> <%= ordem.token %></div>
          <div class="os-item"><strong>Descri√ß√£o:</strong> <%= ordem.descricao %></div>
          <div class="os-item"><strong>Resolu√ß√£o:</strong> <%= ordem.resolucao || 'Ainda n√£o dispon√≠vel' %></div>
        </div>
      </section>
    <% } else { %>
      <section class="sem-ordem">
        <p>
          <i class="fas fa-info-circle"></i>
          Informe seu token para acompanhar sua Ordem de Servi√ßo.
        </p>
      </section>
    <% } %>

  </div>
</main>

<!-- üîµ BOT√ÉO FLUTUANTE ‚Äì NOVA OS -->
<a href="/nova_os" class="btn-nova-os-float" title="Abrir Nova OS">
  <i class="fas fa-plus"></i>
</a>

<footer>
  MBM Copy ¬© Sistema de Ordens de Servi√ßo
</footer>

<script src="/js/indexScripts.js"></script>
</body>
</html>
